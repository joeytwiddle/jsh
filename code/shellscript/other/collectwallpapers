if [ ! "$1" = "" ] && [ ! "$1" = "babes" ] && [ ! "$1" = "babesonly" ]; then
  echo "collectwallpapers [ babestoo | babesonly ]"
  exit 1
fi

cd $JPATH/allwallpapers
chmod u+w *
rm -rf $JPATH/allwallpapers/*

cd $JPATH/wallpapers
echo "" > list
# echo A
forall -shell -stealth * */* */*/* */*/*/* */*/*/*/* do echo "\"%w\"" %p%p list
# echo B

ungrep "^naff/" list | ungrep "^tiles/" | ungrep "^for/" > finallist

if [ "$1" = "babesonly" ]; then
  grep babes finallist > list
  grep mermaids finallist >> list
  grep fairies finallist >> list
  cp list finallist
else
  if [ ! "$1" = "babestoo" ]; then
    ungrep babes finallist | ungrep mermaids | ungrep fairies > list
    cp list finallist
  fi
fi

# echo C
forall -shell -stealth -filesonly in finallist do ln -sf "\"$JPATH/wallpapers/%w\"" "\"$JPATH/allwallpapers/%f\""
# echo D

exit 0