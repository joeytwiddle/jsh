EXECSH=`jgettmp jwatch-do-$1`
NEW=`jgettmp "new-$1"`
OLD=`jgettmp "old-$1"`

echo "$@" > $EXECSH
chmod a+x "$EXECSH"

$EXECSH > $NEW

if test "x$JWATCHCOMPCOM" = "x"; then
  JWATCHCOMPCOM="jfc simple oneway"
fi

sleep 1

while [ true ]; do

	mv $NEW $OLD

	$EXECSH > $NEW

	$JWATCHCOMPCOM $NEW $OLD

	sleep 1

	`breakonctrlc`

done

jdeltmp "$NEW" "$OLD" "$EXECSH"
